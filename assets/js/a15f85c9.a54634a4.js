(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{100:function(e,t,a){"use strict";var r=a(0),n=a.n(r),i=a(97),o=a(94),l=a(56),s=a.n(l);var c=37,p=39;t.a=function(e){var t=e.lazy,a=e.block,l=e.defaultValue,u=e.values,d=e.groupId,m=e.className,b=Object(i.a)(),f=b.tabGroupChoices,h=b.setTabGroupChoices,v=Object(r.useState)(l),O=v[0],g=v[1],y=r.Children.toArray(e.children),j=[];if(null!=d){var N=f[d];null!=N&&N!==O&&u.some((function(e){return e.value===N}))&&g(N)}var w=function(e){var t=e.target,a=j.indexOf(t),r=y[a].props.value;g(r),null!=d&&(h(d,r),setTimeout((function(){var e,a,r,n,i,o,l,c;(e=t.getBoundingClientRect(),a=e.top,r=e.left,n=e.bottom,i=e.right,o=window,l=o.innerHeight,c=o.innerWidth,a>=0&&i<=c&&n<=l&&r>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(s.a.tabItemActive),setTimeout((function(){return t.classList.remove(s.a.tabItemActive)}),2e3))}),150))},P=function(e){var t,a;switch(e.keyCode){case p:var r=j.indexOf(e.target)+1;a=j[r]||j[0];break;case c:var n=j.indexOf(e.target)-1;a=j[n]||j[j.length-1]}null===(t=a)||void 0===t||t.focus()};return n.a.createElement("div",{className:"tabs-container"},n.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(o.a)("tabs",{"tabs--block":a},m)},u.map((function(e){var t=e.value,a=e.label;return n.a.createElement("li",{role:"tab",tabIndex:O===t?0:-1,"aria-selected":O===t,className:Object(o.a)("tabs__item",s.a.tabItem,{"tabs__item--active":O===t}),key:t,ref:function(e){return j.push(e)},onKeyDown:P,onFocus:w,onClick:w},a)}))),t?Object(r.cloneElement)(y.filter((function(e){return e.props.value===O}))[0],{className:"margin-vert--md"}):n.a.createElement("div",{className:"margin-vert--md"},y.map((function(e,t){return Object(r.cloneElement)(e,{key:t,hidden:e.props.value!==O})}))))}},101:function(e,t,a){"use strict";var r=a(0),n=a.n(r);t.a=function(e){var t=e.children,a=e.hidden,r=e.className;return n.a.createElement("div",{role:"tabpanel",hidden:a,className:r},t)}},87:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return s})),a.d(t,"metadata",(function(){return c})),a.d(t,"toc",(function(){return p})),a.d(t,"default",(function(){return d}));var r=a(3),n=a(8),i=(a(0),a(96)),o=a(100),l=a(101),s={title:".family"},c={unversionedId:"concepts/modifiers/family",id:"concepts/modifiers/family",isDocsHomePage:!1,title:".family",description:"Before reading this, consider reading about providers and how to read them.",source:"@site/docs/concepts/modifiers/family.mdx",slug:"/concepts/modifiers/family",permalink:"/river_pod/docs/concepts/modifiers/family",editUrl:"https://github.com/y-moriya/river_pod/edit/ja_docs/website/docs/concepts/modifiers/family.mdx",version:"current",sidebar:"Sidebar",previous:{title:"ProviderObserver",permalink:"/river_pod/docs/concepts/provider_observer"},next:{title:".autoDispose",permalink:"/river_pod/docs/concepts/modifiers/auto_dispose"}},p=[{value:"Usage",id:"usage",children:[]},{value:"Parameter restrictions",id:"parameter-restrictions",children:[{value:"<em>PREFER</em> using <code>autoDispose</code> when the parameter is not constant:",id:"prefer-using-autodispose-when-the-parameter-is-not-constant",children:[]}]},{value:"Passing multiple parameters to a family",id:"passing-multiple-parameters-to-a-family",children:[]}],u={toc:p};function d(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},u,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Before reading this, consider reading about ",Object(i.b)("a",{parentName:"p",href:"/docs/concepts/providers"},"providers")," and ",Object(i.b)("a",{parentName:"p",href:"/docs/concepts/reading"},"how to read them"),".\nIn this part, we will talk in detail about the ",Object(i.b)("inlineCode",{parentName:"p"},".family")," provider modifier."),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},".family")," modifier has one purpose: Creating a provider from external values."),Object(i.b)("p",null,"Some common use-cases for ",Object(i.b)("inlineCode",{parentName:"p"},"family")," would be:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Combining ",Object(i.b)("a",{parentName:"li",href:"https://pub.dev/documentation/riverpod/latest/riverpod/FutureProvider-class.html"},"FutureProvider")," with ",Object(i.b)("inlineCode",{parentName:"li"},".family")," to fetch a ",Object(i.b)("inlineCode",{parentName:"li"},"Message")," from its ID"),Object(i.b)("li",{parentName:"ul"},"Passing the current ",Object(i.b)("inlineCode",{parentName:"li"},"Locale")," to a provider, so that we can handle translations:"),Object(i.b)("li",{parentName:"ul"},"Connecting a provider with another provider without having access to its variable.")),Object(i.b)("h2",{id:"usage"},"Usage"),Object(i.b)("p",null,"The way families works is by adding an extra parameter to the provider.\nThis parameter can then be freely used in our provider to create some state."),Object(i.b)("p",null,"For example, we could combine ",Object(i.b)("inlineCode",{parentName:"p"},"family")," with ",Object(i.b)("a",{parentName:"p",href:"https://pub.dev/documentation/riverpod/latest/riverpod/FutureProvider-class.html"},"FutureProvider")," to fetch\na ",Object(i.b)("inlineCode",{parentName:"p"},"Message")," from its ID:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-dart"},"final messagesFamily = FutureProvider.family<Message, String>((ref, id) async {\n  return dio.get('http://my_api.dev/messages/$id');\n});\n")),Object(i.b)("p",null,"Then, when using our ",Object(i.b)("inlineCode",{parentName:"p"},"messagesFamily")," provider, the syntax is slightly modified.",Object(i.b)("br",{parentName:"p"}),"\n","The usual syntax will not work anymore:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-dart"},"Widget build(BuildContext context, WidgetRef ref) {\n  // Error \u2013 messagesFamily is not a provider\n  final response = ref.watch(messagesFamily);\n}\n")),Object(i.b)("p",null,"Instead, we need to pass a parameter to ",Object(i.b)("inlineCode",{parentName:"p"},"messagesFamily"),":"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-dart"},"Widget build(BuildContext context, WidgetRef ref) {\n  final response = ref.watch(messagesFamily('id'));\n}\n")),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"It is possible to use a family with different parameters simultaneously.",Object(i.b)("br",{parentName:"p"}),"\n","For example, we could use a ",Object(i.b)("inlineCode",{parentName:"p"},"titleFamily")," to read both the french and english\ntranslations at the same time:"),Object(i.b)("pre",{parentName:"div"},Object(i.b)("code",{parentName:"pre",className:"language-dart"},"@override\nWidget build(BuildContext context, WidgetRef ref) {\n  final frenchTitle = ref.watch(titleFamily(const Locale('fr')));\n  final englishTitle = ref.watch(titleFamily(const Locale('en')));\n\n  return Text('fr: $frenchTitle en: $englishTitle');\n}\n")))),Object(i.b)("h2",{id:"parameter-restrictions"},"Parameter restrictions"),Object(i.b)("p",null,"For families to work correctly, it is critical for the parameter passed to\na provider to have a consistent ",Object(i.b)("inlineCode",{parentName:"p"},"hashCode")," and ",Object(i.b)("inlineCode",{parentName:"p"},"=="),"."),Object(i.b)("p",null,"Ideally the parameter should either be a primitive (bool/int/double/String),\na constant (providers), or an immutable object that overrides ",Object(i.b)("inlineCode",{parentName:"p"},"==")," and ",Object(i.b)("inlineCode",{parentName:"p"},"hashCode"),"."),Object(i.b)("h3",{id:"prefer-using-autodispose-when-the-parameter-is-not-constant"},Object(i.b)("em",{parentName:"h3"},"PREFER")," using ",Object(i.b)("inlineCode",{parentName:"h3"},"autoDispose")," when the parameter is not constant:"),Object(i.b)("p",null,"You may want to use families to pass the input of a search field to your provider.\nBut that value can change often and never be reused.",Object(i.b)("br",{parentName:"p"}),"\n","This could cause memory leaks as, by default, a provider is never destroyed even\nif no-longer used."),Object(i.b)("p",null,"Using both ",Object(i.b)("inlineCode",{parentName:"p"},".family")," and ",Object(i.b)("inlineCode",{parentName:"p"},".autoDispose")," fixes that memory leak:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-dart"},"final characters = FutureProvider.autoDispose.family<List<Character>, String>((ref, filter) async {\n  return fetchCharacters(filter: filter);\n});\n")),Object(i.b)("h2",{id:"passing-multiple-parameters-to-a-family"},"Passing multiple parameters to a family"),Object(i.b)("p",null,"Families have no built-in support for passing multiple values to a provider."),Object(i.b)("p",null,"On the other hand, that value could be ",Object(i.b)("em",{parentName:"p"},"anything")," (as long as it matches with\nthe restrictions mentioned previously)."),Object(i.b)("p",null,"This includes:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"A tuple from ",Object(i.b)("a",{parentName:"li",href:"http://pub.dev/packages/tuple"},"tuple")),Object(i.b)("li",{parentName:"ul"},"Objects generated with ",Object(i.b)("a",{parentName:"li",href:"https://pub.dev/packages/freezed"},"Freezed")," or ",Object(i.b)("a",{parentName:"li",href:"https://pub.dev/packages/built_value"},"built_value")),Object(i.b)("li",{parentName:"ul"},"Objects using ",Object(i.b)("a",{parentName:"li",href:"https://pub.dev/packages/equatable"},"equatable"))),Object(i.b)("p",null,"Here's an example using ",Object(i.b)("a",{parentName:"p",href:"https://pub.dev/packages/freezed"},"Freezed")," and ",Object(i.b)("a",{parentName:"p",href:"https://pub.dev/packages/equatable"},"equatable"),":"),Object(i.b)(o.a,{groupId:"family",defaultValue:"freezed",values:[{label:"Freezed",value:"freezed"},{label:"Equatable",value:"equatable"}],mdxType:"Tabs"},Object(i.b)(l.a,{value:"freezed",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-dart"},"@freezed\nabstract class MyParameter with _$MyParameter {\n  factory MyParameter({\n    required int userId,\n    required Locale locale,\n  }) = _MyParameter;\n}\n\nfinal exampleProvider = Provider.autoDispose.family<Something, MyParameter>((ref, myParameter) {\n  print(myParameter.userId);\n  print(myParameter.locale);\n  // Do something with userId/locale\n});\n\n@override\nWidget build(BuildContext context, WidgetRef ref) {\n  int userId; // Read the user ID from somewhere\n  final locale = Localizations.localeOf(context);\n\n  final something = ref.watch(\n    exampleProvider(MyParameter(userId: userId, locale: locale)),\n  );\n\n  ...\n}\n"))),Object(i.b)(l.a,{value:"equatable",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-dart"},"class MyParameter extends Equatable  {\n  MyParameter({\n    required this.userId,\n    required this.locale,\n  });\n\n  final int userId;\n  final Locale locale;\n\n  @override\n  List<Object> get props => [userId, locale];\n}\n\nfinal exampleProvider = Provider.family<Something, MyParameter>((ref, myParameter) {\n  print(myParameter.userId);\n  print(myParameter.locale);\n  // Do something with userId/locale\n});\n\n@override\nWidget build(BuildContext context, WidgetRef ref) {\n  int userId; // Read the user ID from somewhere\n  final locale = Localizations.localeOf(context);\n\n  final something = ref.watch(\n    exampleProvider(MyParameter(userId: userId, locale: locale)),\n  );\n\n  ...\n}\n")))))}d.isMDXComponent=!0},94:function(e,t,a){"use strict";function r(e){var t,a,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(a=r(e[t]))&&(n&&(n+=" "),n+=a);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}t.a=function(){for(var e,t,a=0,n="";a<arguments.length;)(e=arguments[a++])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}},96:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return b}));var r=a(0),n=a.n(r);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=n.a.createContext({}),p=function(e){var t=n.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return n.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},m=n.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(a),m=r,b=u["".concat(o,".").concat(m)]||u[m]||d[m]||i;return a?n.a.createElement(b,l(l({ref:t},c),{},{components:a})):n.a.createElement(b,l({ref:t},c))}));function b(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=a[c];return n.a.createElement.apply(null,o)}return n.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"},97:function(e,t,a){"use strict";var r=a(0),n=a(98);t.a=function(){var e=Object(r.useContext)(n.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},98:function(e,t,a){"use strict";var r=a(0),n=Object(r.createContext)(void 0);t.a=n}}]);